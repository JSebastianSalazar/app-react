{"version":3,"sources":["__prelude__","/data/sandcastle/boxes/trunk-hg-fbcode-fbsource/xplat/flipper-public/static/node_modules/metro/src/lib/polyfills/require.js","/data/sandcastle/boxes/trunk-hg-fbcode-fbsource/xplat/flipper-public/src/plugins/logs/index.js","/data/sandcastle/boxes/trunk-hg-fbcode-fbsource/xplat/flipper-public/src/plugins/logs/LogWatcher.js"],"sourcesContent":["var __DEV__=false,__BUNDLE_START_TIME__=this.nativePerformanceNow?nativePerformanceNow():Date.now(),process=this.process||{};process.env=process.env||{};process.env.NODE_ENV=\"production\";","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @polyfill\n *\n * @format\n */\n\n\"use strict\";\n\n/* eslint-disable no-bitwise */\n\nglobal.__r = metroRequire;\nglobal.__d = define;\nglobal.__c = clear;\n\nvar modules = clear();\n\n// Don't use a Symbol here, it would pull in an extra polyfill with all sorts of\n// additional stuff (e.g. Array.from).\nvar EMPTY = {};\nvar _ref = {},\n  hasOwnProperty = _ref.hasOwnProperty;\n\nfunction clear() {\n  modules =\n    typeof __NUM_MODULES__ === \"number\"\n      ? Array(__NUM_MODULES__ | 0)\n      : Object.create(null);\n\n  // We return modules here so that we can assign an initial value to modules\n  // when defining it. Otherwise, we would have to do \"let modules = null\",\n  // which will force us to add \"nullthrows\" everywhere.\n  return modules;\n}\n\nif (__DEV__) {\n  var verboseNamesToModuleIds = Object.create(null);\n  var initializingModuleIds = [];\n}\n\nfunction define(factory, moduleId, dependencyMap) {\n  if (modules[moduleId] != null) {\n    if (__DEV__) {\n      // (We take `inverseDependencies` from `arguments` to avoid an unused\n      // named parameter in `define` in production.\n      var inverseDependencies = arguments[4];\n\n      // If the module has already been defined and the define method has been\n      // called with inverseDependencies, we can hot reload it.\n      if (inverseDependencies) {\n        global.__accept(moduleId, factory, dependencyMap, inverseDependencies);\n      } else {\n        console.warn(\n          \"Trying to define twice module ID \" + moduleId + \" in the same bundle\"\n        );\n      }\n    }\n\n    // prevent repeated calls to `global.nativeRequire` to overwrite modules\n    // that are already loaded\n    return;\n  }\n  modules[moduleId] = {\n    dependencyMap: dependencyMap,\n    factory: factory,\n    hasError: false,\n    importedAll: EMPTY,\n    importedDefault: EMPTY,\n    isInitialized: false,\n    publicModule: { exports: {} }\n  };\n  if (__DEV__) {\n    // HMR\n    modules[moduleId].hot = createHotReloadingObject();\n\n    // DEBUGGABLE MODULES NAMES\n    // we take `verboseName` from `arguments` to avoid an unused named parameter\n    // in `define` in production.\n    var _verboseName = arguments[3];\n    if (_verboseName) {\n      modules[moduleId].verboseName = _verboseName;\n      verboseNamesToModuleIds[_verboseName] = moduleId;\n    }\n  }\n}\n\nfunction metroRequire(moduleId) {\n  if (__DEV__ && typeof moduleId === \"string\") {\n    var _verboseName2 = moduleId;\n    moduleId = verboseNamesToModuleIds[_verboseName2];\n    if (moduleId == null) {\n      throw new Error('Unknown named module: \"' + _verboseName2 + '\"');\n    } else {\n      console.warn(\n        'Requiring module \"' +\n          _verboseName2 +\n          '\" by name is only supported for ' +\n          \"debugging purposes and will BREAK IN PRODUCTION!\"\n      );\n    }\n  }\n\n  //$FlowFixMe: at this point we know that moduleId is a number\n  var moduleIdReallyIsNumber = moduleId;\n\n  if (__DEV__) {\n    var initializingIndex = initializingModuleIds.indexOf(\n      moduleIdReallyIsNumber\n    );\n    if (initializingIndex !== -1) {\n      var cycle = initializingModuleIds\n        .slice(initializingIndex)\n        .map(function(id) {\n          return modules[id].verboseName;\n        });\n      // We want to show A -> B -> A:\n      cycle.push(cycle[0]);\n      console.warn(\n        \"Require cycle: \" +\n          cycle.join(\" -> \") +\n          \"\\n\\n\" +\n          \"Require cycles are allowed, but can result in uninitialized values. \" +\n          \"Consider refactoring to remove the need for a cycle.\"\n      );\n    }\n  }\n\n  var module = modules[moduleIdReallyIsNumber];\n\n  return module && module.isInitialized\n    ? module.publicModule.exports\n    : guardedLoadModule(moduleIdReallyIsNumber, module);\n}\n\nfunction metroImportDefault(moduleId) {\n  if (__DEV__ && typeof moduleId === \"string\") {\n    var _verboseName3 = moduleId;\n    moduleId = verboseNamesToModuleIds[_verboseName3];\n  }\n\n  //$FlowFixMe: at this point we know that moduleId is a number\n  var moduleIdReallyIsNumber = moduleId;\n\n  if (\n    modules[moduleIdReallyIsNumber] &&\n    modules[moduleIdReallyIsNumber].importedDefault !== EMPTY\n  ) {\n    return modules[moduleIdReallyIsNumber].importedDefault;\n  }\n\n  var exports = metroRequire(moduleIdReallyIsNumber);\n  var importedDefault =\n    exports && exports.__esModule ? exports.default : exports;\n\n  return (modules[moduleIdReallyIsNumber].importedDefault = importedDefault);\n}\n\nfunction metroImportAll(moduleId) {\n  if (__DEV__ && typeof moduleId === \"string\") {\n    var _verboseName4 = moduleId;\n    moduleId = verboseNamesToModuleIds[_verboseName4];\n  }\n\n  //$FlowFixMe: at this point we know that moduleId is a number\n  var moduleIdReallyIsNumber = moduleId;\n\n  if (\n    modules[moduleIdReallyIsNumber] &&\n    modules[moduleIdReallyIsNumber].importedAll !== EMPTY\n  ) {\n    return modules[moduleIdReallyIsNumber].importedAll;\n  }\n\n  var exports = metroRequire(moduleIdReallyIsNumber);\n  var importedAll = void 0;\n\n  if (exports && exports.__esModule) {\n    importedAll = exports;\n  } else {\n    importedAll = {};\n\n    // Refrain from using Object.assign, it has to work in ES3 environments.\n    if (exports) {\n      for (var _key in exports) {\n        if (hasOwnProperty.call(exports, _key)) {\n          importedAll[_key] = exports[_key];\n        }\n      }\n    }\n\n    importedAll.default = exports;\n  }\n\n  return (modules[moduleIdReallyIsNumber].importedAll = importedAll);\n}\n\nvar inGuard = false;\nfunction guardedLoadModule(moduleId, module) {\n  if (!inGuard && global.ErrorUtils) {\n    inGuard = true;\n    var returnValue = void 0;\n    try {\n      returnValue = loadModuleImplementation(moduleId, module);\n    } catch (e) {\n      global.ErrorUtils.reportFatalError(e);\n    }\n    inGuard = false;\n    return returnValue;\n  } else {\n    return loadModuleImplementation(moduleId, module);\n  }\n}\n\nvar ID_MASK_SHIFT = 16;\nvar LOCAL_ID_MASK = ~0 >>> ID_MASK_SHIFT;\n\nfunction unpackModuleId(moduleId) {\n  var segmentId = moduleId >>> ID_MASK_SHIFT;\n  var localId = moduleId & LOCAL_ID_MASK;\n  return { segmentId: segmentId, localId: localId };\n}\nmetroRequire.unpackModuleId = unpackModuleId;\n\nfunction packModuleId(value) {\n  return (value.segmentId << ID_MASK_SHIFT) + value.localId;\n}\nmetroRequire.packModuleId = packModuleId;\n\nvar hooks = [];\nfunction registerHook(cb) {\n  var hook = { cb: cb };\n  hooks.push(hook);\n  return {\n    release: function release() {\n      for (var i = 0; i < hooks.length; ++i) {\n        if (hooks[i] === hook) {\n          hooks.splice(i, 1);\n          break;\n        }\n      }\n    }\n  };\n}\nmetroRequire.registerHook = registerHook;\n\nfunction loadModuleImplementation(moduleId, module) {\n  if (!module && global.__defineModule) {\n    global.__defineModule(moduleId);\n    module = modules[moduleId];\n  }\n\n  var nativeRequire = global.nativeRequire;\n  if (!module && nativeRequire) {\n    var _unpackModuleId = unpackModuleId(moduleId),\n      _segmentId = _unpackModuleId.segmentId,\n      _localId = _unpackModuleId.localId;\n\n    nativeRequire(_localId, _segmentId);\n    module = modules[moduleId];\n  }\n\n  if (!module) {\n    throw unknownModuleError(moduleId);\n  }\n\n  if (module.hasError) {\n    throw moduleThrewError(moduleId, module.error);\n  }\n\n  // `metroRequire` calls into the require polyfill itself are not analyzed and\n  // replaced so that they use numeric module IDs.\n  // The systrace module will expose itself on the metroRequire function so that\n  // it can be used here.\n  // TODO(davidaurelio) Scan polyfills for dependencies, too (t9759686)\n  if (__DEV__) {\n    var Systrace = metroRequire.Systrace;\n  }\n\n  // We must optimistically mark module as initialized before running the\n  // factory to keep any require cycles inside the factory from causing an\n  // infinite require loop.\n  module.isInitialized = true;\n\n  var _module = module,\n    factory = _module.factory,\n    dependencyMap = _module.dependencyMap;\n\n  if (__DEV__) {\n    initializingModuleIds.push(moduleId);\n  }\n  try {\n    if (__DEV__) {\n      // $FlowFixMe: we know that __DEV__ is const and `Systrace` exists\n      Systrace.beginEvent(\"JS_require_\" + (module.verboseName || moduleId));\n    }\n\n    var _moduleObject = module.publicModule;\n\n    if (__DEV__) {\n      if (module.hot) {\n        _moduleObject.hot = module.hot;\n      }\n    }\n    _moduleObject.id = moduleId;\n\n    if (hooks.length > 0) {\n      for (var i = 0; i < hooks.length; ++i) {\n        hooks[i].cb(moduleId, _moduleObject);\n      }\n    }\n\n    // keep args in sync with with defineModuleCode in\n    // metro/src/Resolver/index.js\n    // and metro/src/ModuleGraph/worker.js\n    factory(\n      global,\n      metroRequire,\n      metroImportDefault,\n      metroImportAll,\n      _moduleObject,\n      _moduleObject.exports,\n      dependencyMap\n    );\n\n    // avoid removing factory in DEV mode as it breaks HMR\n    if (!__DEV__) {\n      // $FlowFixMe: This is only sound because we never access `factory` again\n      module.factory = undefined;\n      module.dependencyMap = undefined;\n    }\n\n    if (__DEV__) {\n      // $FlowFixMe: we know that __DEV__ is const and `Systrace` exists\n      Systrace.endEvent();\n    }\n    return _moduleObject.exports;\n  } catch (e) {\n    module.hasError = true;\n    module.error = e;\n    module.isInitialized = false;\n    module.publicModule.exports = undefined;\n    throw e;\n  } finally {\n    if (__DEV__) {\n      if (initializingModuleIds.pop() !== moduleId) {\n        throw new Error(\n          \"initializingModuleIds is corrupt; something is terribly wrong\"\n        );\n      }\n    }\n  }\n}\n\nfunction unknownModuleError(id) {\n  var message = 'Requiring unknown module \"' + id + '\".';\n  if (__DEV__) {\n    message +=\n      \"If you are sure the module is there, try restarting Metro Bundler. \" +\n      \"You may also want to run `yarn`, or `npm install` (depending on your environment).\";\n  }\n  return Error(message);\n}\n\nfunction moduleThrewError(id, error) {\n  var displayName = (__DEV__ && modules[id] && modules[id].verboseName) || id;\n  return Error(\n    'Requiring module \"' + displayName + '\", which threw an exception: ' + error\n  );\n}\n\nif (__DEV__) {\n  metroRequire.Systrace = {\n    beginEvent: function beginEvent() {},\n    endEvent: function endEvent() {}\n  };\n\n  metroRequire.getModules = function() {\n    return modules;\n  };\n\n  // HOT MODULE RELOADING\n  var createHotReloadingObject = function createHotReloadingObject() {\n    var hot = {\n      acceptCallback: null,\n      accept: function accept(callback) {\n        hot.acceptCallback = callback;\n      },\n      disposeCallback: null,\n      dispose: function dispose(callback) {\n        hot.disposeCallback = callback;\n      }\n    };\n    return hot;\n  };\n\n  var metroAcceptAll = function metroAcceptAll(\n    dependentModules,\n    inverseDependencies,\n    patchedModules\n  ) {\n    if (!dependentModules || dependentModules.length === 0) {\n      return true;\n    }\n\n    var notAccepted = dependentModules.filter(function(module) {\n      return !metroAccept(\n        module,\n        /*factory*/ undefined,\n        /*dependencyMap*/ undefined,\n        inverseDependencies,\n        patchedModules\n      );\n    });\n\n    var parents = [];\n    for (var i = 0; i < notAccepted.length; i++) {\n      // if the module has no parents then the change cannot be hot loaded\n      if (inverseDependencies[notAccepted[i]].length === 0) {\n        return false;\n      }\n\n      parents.push.apply(parents, inverseDependencies[notAccepted[i]]);\n    }\n\n    return parents.length == 0;\n  };\n\n  var metroAccept = function metroAccept(\n    id,\n    factory,\n    dependencyMap,\n    inverseDependencies\n  ) {\n    var patchedModules =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n    if (id in patchedModules) {\n      // Do not patch the same module more that once during an update.\n      return true;\n    }\n    patchedModules[id] = true;\n\n    var mod = modules[id];\n\n    if (!mod && factory) {\n      // New modules are going to be handled by the define() method.\n      return true;\n    }\n\n    var hot = mod.hot;\n\n    if (!hot) {\n      console.warn(\n        \"Cannot accept module because Hot Module Replacement \" +\n          \"API was not installed.\"\n      );\n      return false;\n    }\n\n    if (hot.disposeCallback) {\n      try {\n        hot.disposeCallback();\n      } catch (error) {\n        console.error(\n          \"Error while calling dispose handler for module \" + id + \": \",\n          error\n        );\n      }\n    }\n\n    // replace and initialize factory\n    if (factory) {\n      mod.factory = factory;\n    }\n    if (dependencyMap) {\n      mod.dependencyMap = dependencyMap;\n    }\n    mod.hasError = false;\n    mod.isInitialized = false;\n    metroRequire(id);\n\n    if (hot.acceptCallback) {\n      try {\n        hot.acceptCallback();\n        return true;\n      } catch (error) {\n        console.error(\n          \"Error while calling accept handler for module \" + id + \": \",\n          error\n        );\n      }\n    }\n\n    // need to have inverseDependencies to bubble up accept\n    if (!inverseDependencies) {\n      throw new Error(\"Undefined `inverseDependencies`\");\n    }\n\n    // accept parent modules recursively up until all siblings are accepted\n    return metroAcceptAll(\n      inverseDependencies[id],\n      inverseDependencies,\n      patchedModules\n    );\n  };\n\n  global.__accept = metroAccept;\n}\n","/**\n * Copyright 2018-present Facebook.\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n * @format\n */\n\nimport type {\n  TableBodyRow,\n  TableColumnOrder,\n  TableColumnSizes,\n  TableColumns,\n} from 'flipper';\nimport type {Counter} from './LogWatcher.js';\nimport type {DeviceLogEntry} from '../../devices/BaseDevice.js';\nimport type {Props as PluginProps} from '../../plugin';\n\nimport {\n  Text,\n  ManagedTable,\n  Button,\n  colors,\n  ContextMenu,\n  FlexColumn,\n  Glyph,\n  DetailSidebar,\n  FlipperDevicePlugin,\n  SearchableTable,\n  styled,\n  Device,\n  createPaste,\n  textContent,\n} from 'flipper';\nimport LogWatcher from './LogWatcher';\n\nconst LOG_WATCHER_LOCAL_STORAGE_KEY = 'LOG_WATCHER_LOCAL_STORAGE_KEY';\n\ntype Entries = Array<{\n  row: TableBodyRow,\n  entry: DeviceLogEntry,\n}>;\n\ntype State = {|\n  rows: Array<TableBodyRow>,\n  entries: Entries,\n  key2entry: {[key: string]: DeviceLogEntry},\n  highlightedRows: Set<string>,\n  counters: Array<Counter>,\n|};\n\ntype Actions = {||};\n\ntype PersistedState = {||};\n\nconst Icon = styled(Glyph)({\n  marginTop: 5,\n});\n\nfunction getLineCount(str: string): number {\n  let count = 1;\n  for (let i = 0; i < str.length; i++) {\n    if (str[i] === '\\n') {\n      count++;\n    }\n  }\n  return count;\n}\n\nfunction keepKeys(obj, keys) {\n  const result = {};\n  for (const key in obj) {\n    if (keys.includes(key)) {\n      result[key] = obj[key];\n    }\n  }\n  return result;\n}\n\nconst COLUMN_SIZE = {\n  type: 40,\n  time: 120,\n  pid: 60,\n  tid: 60,\n  tag: 120,\n  app: 200,\n  message: 'flex',\n};\n\nconst COLUMNS = {\n  type: {\n    value: '',\n  },\n  time: {\n    value: 'Time',\n  },\n  pid: {\n    value: 'PID',\n  },\n  tid: {\n    value: 'TID',\n  },\n  tag: {\n    value: 'Tag',\n  },\n  app: {\n    value: 'App',\n  },\n  message: {\n    value: 'Message',\n  },\n};\n\nconst INITIAL_COLUMN_ORDER = [\n  {\n    key: 'type',\n    visible: true,\n  },\n  {\n    key: 'time',\n    visible: false,\n  },\n  {\n    key: 'pid',\n    visible: false,\n  },\n  {\n    key: 'tid',\n    visible: false,\n  },\n  {\n    key: 'tag',\n    visible: true,\n  },\n  {\n    key: 'app',\n    visible: true,\n  },\n  {\n    key: 'message',\n    visible: true,\n  },\n];\n\nconst LOG_TYPES: {\n  [level: string]: {\n    label: string,\n    color: string,\n    icon?: React.Node,\n    style?: Object,\n  },\n} = {\n  verbose: {\n    label: 'Verbose',\n    color: colors.purple,\n  },\n  debug: {\n    label: 'Debug',\n    color: colors.grey,\n  },\n  info: {\n    label: 'Info',\n    icon: <Icon name=\"info-circle\" color={colors.cyan} />,\n    color: colors.cyan,\n  },\n  warn: {\n    label: 'Warn',\n    style: {\n      backgroundColor: colors.yellowTint,\n      color: colors.yellow,\n      fontWeight: 500,\n    },\n    icon: <Icon name=\"caution-triangle\" color={colors.yellow} />,\n    color: colors.yellow,\n  },\n  error: {\n    label: 'Error',\n    style: {\n      backgroundColor: colors.redTint,\n      color: colors.red,\n      fontWeight: 500,\n    },\n    icon: <Icon name=\"caution-octagon\" color={colors.red} />,\n    color: colors.red,\n  },\n  fatal: {\n    label: 'Fatal',\n    style: {\n      backgroundColor: colors.redTint,\n      color: colors.red,\n      fontWeight: 700,\n    },\n    icon: <Icon name=\"stop\" color={colors.red} />,\n    color: colors.red,\n  },\n};\n\nconst DEFAULT_FILTERS = [\n  {\n    type: 'enum',\n    enum: Object.keys(LOG_TYPES).map(value => ({\n      label: LOG_TYPES[value].label,\n      value,\n    })),\n    key: 'type',\n    value: [],\n    persistent: true,\n  },\n];\n\nconst HiddenScrollText = styled(Text)({\n  alignSelf: 'baseline',\n  userSelect: 'none',\n  lineHeight: '130%',\n  marginTop: 5,\n  paddingBottom: 3,\n  '&::-webkit-scrollbar': {\n    display: 'none',\n  },\n});\n\nconst LogCount = styled('div')(({backgroundColor}) => ({\n  backgroundColor,\n  borderRadius: '999em',\n  fontSize: 11,\n  marginTop: 4,\n  minWidth: 16,\n  height: 16,\n  color: colors.white,\n  textAlign: 'center',\n  lineHeight: '16px',\n  paddingLeft: 4,\n  paddingRight: 4,\n  textOverflow: 'ellipsis',\n  overflow: 'hidden',\n  whiteSpace: 'nowrap',\n}));\n\nfunction pad(chunk: mixed, len: number): string {\n  let str = String(chunk);\n  while (str.length < len) {\n    str = `0${str}`;\n  }\n  return str;\n}\n\nexport function addEntriesToState(\n  items: Entries,\n  state: $Shape<State> = {\n    rows: [],\n    entries: [],\n    key2entry: {},\n  },\n): $Shape<State> {\n  const rows = [...state.rows];\n  const entries = [...state.entries];\n  const key2entry = {...state.key2entry};\n\n  for (let i = 0; i < items.length; i++) {\n    const {entry, row} = items[i];\n    entries.push({row, entry});\n    key2entry[row.key] = entry;\n\n    let previousEntry: ?DeviceLogEntry = null;\n\n    if (i > 0) {\n      previousEntry = items[i - 1].entry;\n    } else if (state.rows.length > 0 && state.entries.length > 0) {\n      previousEntry = state.entries[state.entries.length - 1].entry;\n    }\n\n    addRowIfNeeded(rows, row, entry, previousEntry);\n  }\n\n  return {\n    entries,\n    rows,\n    key2entry,\n  };\n}\n\nexport function addRowIfNeeded(\n  rows: Array<TableBodyRow>,\n  row: TableBodyRow,\n  entry: DeviceLogEntry,\n  previousEntry: ?DeviceLogEntry,\n) {\n  const previousRow = rows.length > 0 ? rows[rows.length - 1] : null;\n  if (\n    previousRow &&\n    previousEntry &&\n    entry.message === previousEntry.message &&\n    entry.tag === previousEntry.tag &&\n    previousRow.type != null\n  ) {\n    // duplicate log, increase counter\n    const count =\n      previousRow.columns.type.value &&\n      previousRow.columns.type.value.props &&\n      typeof previousRow.columns.type.value.props.children === 'number'\n        ? previousRow.columns.type.value.props.children + 1\n        : 2;\n    const type = LOG_TYPES[previousRow.type] || LOG_TYPES.debug;\n    previousRow.columns.type.value = (\n      <LogCount backgroundColor={type.color}>{count}</LogCount>\n    );\n  } else {\n    rows.push(row);\n  }\n}\n\nexport function processEntry(\n  entry: DeviceLogEntry,\n  key: string,\n): {\n  row: TableBodyRow,\n  entry: DeviceLogEntry,\n} {\n  const {icon, style} = LOG_TYPES[(entry.type: string)] || LOG_TYPES.debug;\n  // build the item, it will either be batched or added straight away\n  return {\n    entry,\n    row: {\n      columns: {\n        type: {\n          value: icon,\n          align: 'center',\n        },\n        time: {\n          value: (\n            <HiddenScrollText code={true}>\n              {entry.date.toTimeString().split(' ')[0] +\n                '.' +\n                pad(entry.date.getMilliseconds(), 3)}\n            </HiddenScrollText>\n          ),\n        },\n        message: {\n          value: (\n            <HiddenScrollText code={true}>{entry.message}</HiddenScrollText>\n          ),\n        },\n        tag: {\n          value: <HiddenScrollText code={true}>{entry.tag}</HiddenScrollText>,\n          isFilterable: true,\n        },\n        pid: {\n          value: (\n            <HiddenScrollText code={true}>{String(entry.pid)}</HiddenScrollText>\n          ),\n          isFilterable: true,\n        },\n        tid: {\n          value: (\n            <HiddenScrollText code={true}>{String(entry.tid)}</HiddenScrollText>\n          ),\n          isFilterable: true,\n        },\n        app: {\n          value: <HiddenScrollText code={true}>{entry.app}</HiddenScrollText>,\n          isFilterable: true,\n        },\n      },\n      height: getLineCount(entry.message) * 15 + 10, // 15px per line height + 8px padding\n      style,\n      type: entry.type,\n      filterValue: entry.message,\n      key,\n    },\n  };\n}\n\nexport default class LogTable extends FlipperDevicePlugin<\n  State,\n  Actions,\n  PersistedState,\n> {\n  static keyboardActions = ['clear', 'goToBottom', 'createPaste'];\n\n  initTimer: ?TimeoutID;\n  batchTimer: ?TimeoutID;\n\n  static supportsDevice(device: Device) {\n    return device.os === 'iOS' || device.os === 'Android';\n  }\n\n  onKeyboardAction = (action: string) => {\n    if (action === 'clear') {\n      this.clearLogs();\n    } else if (action === 'goToBottom') {\n      this.goToBottom();\n    } else if (action === 'createPaste') {\n      this.createPaste();\n    }\n  };\n\n  restoreSavedCounters = (): Array<Counter> => {\n    const savedCounters =\n      window.localStorage.getItem(LOG_WATCHER_LOCAL_STORAGE_KEY) || '[]';\n    return JSON.parse(savedCounters).map((counter: Counter) => ({\n      ...counter,\n      expression: new RegExp(counter.label, 'gi'),\n      count: 0,\n    }));\n  };\n\n  calculateHighlightedRows = (\n    deepLinkPayload: ?string,\n    rows: Array<TableBodyRow>,\n  ): Set<string> => {\n    const highlightedRows = new Set();\n    if (!deepLinkPayload) {\n      return highlightedRows;\n    }\n\n    // Run through array from last to first, because we want to show the last\n    // time it the log we are looking for appeared.\n    for (let i = rows.length - 1; i >= 0; i--) {\n      if (\n        rows[i].filterValue &&\n        rows[i].filterValue.includes(deepLinkPayload)\n      ) {\n        highlightedRows.add(rows[i].key);\n        break;\n      }\n    }\n    return highlightedRows;\n  };\n\n  tableRef: ?ManagedTable;\n  columns: TableColumns;\n  columnSizes: TableColumnSizes;\n  columnOrder: TableColumnOrder;\n  logListener: ?Symbol;\n\n  batch: Entries = [];\n  queued: boolean = false;\n  counter: number = 0;\n\n  constructor(props: PluginProps<PersistedState>) {\n    super(props);\n    const supportedColumns = this.device.supportedColumns();\n    this.columns = keepKeys(COLUMNS, supportedColumns);\n    this.columnSizes = keepKeys(COLUMN_SIZE, supportedColumns);\n    this.columnOrder = INITIAL_COLUMN_ORDER.filter(obj =>\n      supportedColumns.includes(obj.key),\n    );\n\n    const initialState = addEntriesToState(\n      this.device\n        .getLogs()\n        .map(log => processEntry(log, String(this.counter++))),\n    );\n    this.state = {\n      ...initialState,\n      highlightedRows: this.calculateHighlightedRows(\n        props.deepLinkPayload,\n        initialState.rows,\n      ),\n      counters: this.restoreSavedCounters(),\n    };\n\n    this.logListener = this.device.addLogListener((entry: DeviceLogEntry) => {\n      const processedEntry = processEntry(entry, String(this.counter++));\n      this.incrementCounterIfNeeded(processedEntry.entry);\n      this.scheudleEntryForBatch(processedEntry);\n    });\n  }\n\n  incrementCounterIfNeeded = (entry: DeviceLogEntry) => {\n    let counterUpdated = false;\n    const counters = this.state.counters.map(counter => {\n      if (entry.message.match(counter.expression)) {\n        counterUpdated = true;\n        if (counter.notify) {\n          new window.Notification(`${counter.label}`, {\n            body: 'The watched log message appeared',\n          });\n        }\n        return {\n          ...counter,\n          count: counter.count + 1,\n        };\n      } else {\n        return counter;\n      }\n    });\n    if (counterUpdated) {\n      this.setState({counters});\n    }\n  };\n\n  scheudleEntryForBatch = (item: {\n    row: TableBodyRow,\n    entry: DeviceLogEntry,\n  }) => {\n    // batch up logs to be processed every 250ms, if we have lots of log\n    // messages coming in, then calling an setState 200+ times is actually\n    // pretty expensive\n    this.batch.push(item);\n\n    if (!this.queued) {\n      this.queued = true;\n\n      this.batchTimer = setTimeout(() => {\n        const thisBatch = this.batch;\n        this.batch = [];\n        this.queued = false;\n        this.setState(state => addEntriesToState(thisBatch, state));\n      }, 100);\n    }\n  };\n\n  componentWillUnmount() {\n    if (this.batchTimer) {\n      clearTimeout(this.batchTimer);\n    }\n\n    if (this.logListener) {\n      this.device.removeLogListener(this.logListener);\n    }\n  }\n\n  clearLogs = () => {\n    this.device.clearLogs().catch(e => {\n      console.error('Failed to clear logs: ', e);\n    });\n    this.setState({\n      entries: [],\n      rows: [],\n      highlightedRows: new Set(),\n      key2entry: {},\n      counters: this.state.counters.map(counter => ({\n        ...counter,\n        count: 0,\n      })),\n    });\n  };\n\n  createPaste = () => {\n    let paste = '';\n    const mapFn = row =>\n      Object.keys(COLUMNS)\n        .map(key => textContent(row.columns[key].value))\n        .join('\\t');\n\n    if (this.state.highlightedRows.size > 0) {\n      // create paste from selection\n      paste = this.state.rows\n        .filter(row => this.state.highlightedRows.has(row.key))\n        .map(mapFn)\n        .join('\\n');\n    } else {\n      // create paste with all rows\n      paste = this.state.rows.map(mapFn).join('\\n');\n    }\n    createPaste(paste);\n  };\n\n  setTableRef = (ref: React.ElementRef<typeof ManagedTable>) => {\n    this.tableRef = ref;\n  };\n\n  goToBottom = () => {\n    if (this.tableRef != null) {\n      this.tableRef.scrollToBottom();\n    }\n  };\n\n  onRowHighlighted = (highlightedRows: Array<string>) => {\n    this.setState({\n      ...this.state,\n      highlightedRows: new Set(highlightedRows),\n    });\n  };\n\n  renderSidebar = () => {\n    return (\n      <LogWatcher\n        counters={this.state.counters}\n        onChange={counters =>\n          this.setState({counters}, () =>\n            window.localStorage.setItem(\n              LOG_WATCHER_LOCAL_STORAGE_KEY,\n              JSON.stringify(this.state.counters),\n            ),\n          )\n        }\n      />\n    );\n  };\n\n  static ContextMenu = styled(ContextMenu)({\n    flex: 1,\n  });\n\n  buildContextMenuItems = () => [\n    {\n      type: 'separator',\n    },\n    {\n      label: 'Clear all',\n      click: this.clearLogs,\n    },\n  ];\n\n  render() {\n    return (\n      <LogTable.ContextMenu\n        buildItems={this.buildContextMenuItems}\n        component={FlexColumn}>\n        <SearchableTable\n          innerRef={this.setTableRef}\n          floating={false}\n          multiline={true}\n          columnSizes={this.columnSizes}\n          columnOrder={this.columnOrder}\n          columns={this.columns}\n          rows={this.state.rows}\n          highlightedRows={this.state.highlightedRows}\n          onRowHighlighted={this.onRowHighlighted}\n          multiHighlight={true}\n          defaultFilters={DEFAULT_FILTERS}\n          zebra={false}\n          actions={<Button onClick={this.clearLogs}>Clear Logs</Button>}\n          // If the logs is opened through deeplink, then don't scroll as the row is highlighted\n          stickyBottom={\n            !(this.props.deepLinkPayload && this.state.highlightedRows.size > 0)\n          }\n        />\n        <DetailSidebar>{this.renderSidebar()}</DetailSidebar>\n      </LogTable.ContextMenu>\n    );\n  }\n}\n","/**\n * Copyright 2018-present Facebook.\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n * @format\n */\n\nimport type {TableBodyRow} from 'flipper';\n\nimport {\n  PureComponent,\n  FlexColumn,\n  Panel,\n  Input,\n  Toolbar,\n  Text,\n  ManagedTable,\n  Button,\n  colors,\n  styled,\n} from 'flipper';\n\nexport type Counter = {\n  expression: RegExp,\n  count: number,\n  notify: boolean,\n  label: string,\n};\n\ntype Props = {|\n  onChange: (counters: Array<Counter>) => void,\n  counters: Array<Counter>,\n|};\n\ntype State = {\n  input: string,\n  highlightedRow: ?string,\n};\n\nconst ColumnSizes = {\n  expression: '70%',\n  count: '15%',\n  notify: 'flex',\n};\n\nconst Columns = {\n  expression: {\n    value: 'Expression',\n    resizable: false,\n  },\n  count: {\n    value: 'Count',\n    resizable: false,\n  },\n  notify: {\n    value: 'Notify',\n    resizable: false,\n  },\n};\n\nconst Count = styled(Text)({\n  alignSelf: 'center',\n  background: colors.macOSHighlightActive,\n  color: colors.white,\n  fontSize: 12,\n  fontWeight: 500,\n  textAlign: 'center',\n  borderRadius: '999em',\n  padding: '4px 9px 3px',\n  lineHeight: '100%',\n  marginLeft: 'auto',\n});\n\nconst Checkbox = styled(Input)({\n  lineHeight: '100%',\n  padding: 0,\n  margin: 0,\n  height: 'auto',\n  alignSelf: 'center',\n});\n\nconst ExpressionInput = styled(Input)({\n  flexGrow: 1,\n});\n\nconst WatcherPanel = styled(Panel)({\n  minHeight: 200,\n});\n\nexport default class LogWatcher extends PureComponent<Props, State> {\n  state = {\n    input: '',\n    highlightedRow: null,\n  };\n\n  _inputRef: ?HTMLInputElement;\n\n  onAdd = () => {\n    if (\n      this.props.counters.findIndex(({label}) => label === this.state.input) >\n        -1 ||\n      this.state.input.length === 0\n    ) {\n      // prevent duplicates\n      return;\n    }\n    this.props.onChange([\n      ...this.props.counters,\n      {\n        label: this.state.input,\n        expression: new RegExp(this.state.input, 'gi'),\n        notify: false,\n        count: 0,\n      },\n    ]);\n    this.setState({input: ''});\n  };\n\n  onChange = (e: SyntheticInputEvent<HTMLInputElement>) => {\n    this.setState({\n      input: e.target.value,\n    });\n  };\n\n  resetCount = (index: number) => {\n    const newCounters = [...this.props.counters];\n    newCounters[index] = {\n      ...newCounters[index],\n      count: 0,\n    };\n    this.props.onChange(newCounters);\n  };\n\n  buildRows = (): Array<TableBodyRow> => {\n    return this.props.counters.map(({label, count, notify}, i) => ({\n      columns: {\n        expression: {\n          value: <Text code={true}>{label}</Text>,\n        },\n        count: {\n          value: <Count onClick={() => this.resetCount(i)}>{count}</Count>,\n        },\n        notify: {\n          value: (\n            <Checkbox\n              type=\"checkbox\"\n              checked={notify}\n              onChange={() => this.setNotification(i, !notify)}\n            />\n          ),\n        },\n      },\n      key: label,\n    }));\n  };\n\n  setNotification = (index: number, notify: boolean) => {\n    const newCounters: Array<Counter> = [...this.props.counters];\n    newCounters[index] = {\n      ...newCounters[index],\n      notify,\n    };\n    this.props.onChange(newCounters);\n  };\n\n  onRowHighlighted = (rows: Array<string>) => {\n    this.setState({\n      highlightedRow: rows.length === 1 ? rows[0] : null,\n    });\n  };\n\n  onKeyDown = (e: SyntheticKeyboardEvent<>) => {\n    if (\n      (e.key === 'Delete' || e.key === 'Backspace') &&\n      this.state.highlightedRow != null\n    ) {\n      this.props.onChange(\n        this.props.counters.filter(\n          ({label}) => label !== this.state.highlightedRow,\n        ),\n      );\n    }\n  };\n\n  onSubmit = (e: SyntheticKeyboardEvent<>) => {\n    if (e.key === 'Enter') {\n      this.onAdd();\n    }\n  };\n\n  render() {\n    return (\n      <FlexColumn grow={true} tabIndex={-1} onKeyDown={this.onKeyDown}>\n        <WatcherPanel\n          heading=\"Expression Watcher\"\n          floating={false}\n          padded={false}>\n          <Toolbar>\n            <ExpressionInput\n              value={this.state.input}\n              placeholder=\"Expression...\"\n              onChange={this.onChange}\n              onKeyDown={this.onSubmit}\n            />\n            <Button\n              onClick={this.onAdd}\n              disabled={this.state.input.length === 0}>\n              Add counter\n            </Button>\n          </Toolbar>\n          <ManagedTable\n            onRowHighlighted={this.onRowHighlighted}\n            columnSizes={ColumnSizes}\n            columns={Columns}\n            rows={this.buildRows()}\n            autoHeight={true}\n            floating={false}\n            zebra={false}\n          />\n        </WatcherPanel>\n      </FlexColumn>\n    );\n  }\n}\n"],"names":["global","__r","metroRequire","__d","define","__c","clear","modules","EMPTY","_ref","hasOwnProperty","__NUM_MODULES__","Array","Object","create","factory","moduleId","dependencyMap","hasError","importedAll","importedDefault","isInitialized","publicModule","exports","moduleIdReallyIsNumber","module","guardedLoadModule","metroImportDefault","__esModule","default","metroImportAll","_key","call","inGuard","ErrorUtils","returnValue","loadModuleImplementation","e","reportFatalError","ID_MASK_SHIFT","LOCAL_ID_MASK","unpackModuleId","segmentId","localId","packModuleId","value","hooks","registerHook","cb","hook","push","release","i","length","splice","__defineModule","nativeRequire","_unpackModuleId","_segmentId","_localId","unknownModuleError","moduleThrewError","error","_module","_moduleObject","id","undefined","message","Error","displayName","LOG_WATCHER_LOCAL_STORAGE_KEY","Icon","Glyph","marginTop","getLineCount","str","count","keepKeys","obj","keys","result","key","includes","COLUMN_SIZE","type","time","pid","tid","tag","app","COLUMNS","INITIAL_COLUMN_ORDER","visible","LOG_TYPES","verbose","label","color","colors","purple","debug","grey","info","icon","cyan","warn","style","backgroundColor","yellowTint","yellow","fontWeight","redTint","red","fatal","DEFAULT_FILTERS","enum","map","persistent","HiddenScrollText","Text","alignSelf","userSelect","lineHeight","paddingBottom","display","LogCount","borderRadius","fontSize","minWidth","height","white","textAlign","paddingLeft","paddingRight","textOverflow","overflow","whiteSpace","pad","chunk","len","String","addEntriesToState","items","state","rows","entries","key2entry","entry","row","previousEntry","addRowIfNeeded","previousRow","columns","props","children","processEntry","align","date","toTimeString","split","getMilliseconds","isFilterable","filterValue","LogTable","FlipperDevicePlugin","supportsDevice","device","os","constructor","action","clearLogs","goToBottom","createPaste","savedCounters","window","localStorage","getItem","JSON","parse","counter","expression","RegExp","deepLinkPayload","highlightedRows","Set","add","counterUpdated","counters","match","notify","Notification","body","setState","item","batch","queued","batchTimer","setTimeout","thisBatch","catch","console","paste","mapFn","join","size","filter","has","ref","tableRef","scrollToBottom","setItem","stringify","click","supportedColumns","columnSizes","columnOrder","initialState","getLogs","log","calculateHighlightedRows","restoreSavedCounters","logListener","addLogListener","processedEntry","incrementCounterIfNeeded","scheudleEntryForBatch","componentWillUnmount","clearTimeout","removeLogListener","render","buildContextMenuItems","FlexColumn","setTableRef","onRowHighlighted","renderSidebar","ContextMenu","flex","ColumnSizes","Columns","resizable","Count","background","macOSHighlightActive","padding","marginLeft","Checkbox","Input","margin","ExpressionInput","flexGrow","WatcherPanel","Panel","minHeight","LogWatcher","PureComponent","input","highlightedRow","findIndex","onChange","target","index","newCounters","resetCount","setNotification","onAdd","onKeyDown","onSubmit","buildRows"],"mappings":"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"}