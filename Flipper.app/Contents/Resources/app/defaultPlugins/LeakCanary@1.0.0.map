{"version":3,"sources":["__prelude__","/data/sandcastle/boxes/trunk-hg-fbcode-fbsource/xplat/flipper-public/static/node_modules/metro/src/lib/polyfills/require.js","/data/sandcastle/boxes/trunk-hg-fbcode-fbsource/xplat/flipper-public/src/plugins/leak_canary/index.js","/data/sandcastle/boxes/trunk-hg-fbcode-fbsource/xplat/flipper-public/src/plugins/leak_canary/processLeakString.js"],"sourcesContent":["var __DEV__=false,__BUNDLE_START_TIME__=this.nativePerformanceNow?nativePerformanceNow():Date.now(),process=this.process||{};process.env=process.env||{};process.env.NODE_ENV=\"production\";","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @polyfill\n *\n * @format\n */\n\n\"use strict\";\n\n/* eslint-disable no-bitwise */\n\nglobal.__r = metroRequire;\nglobal.__d = define;\nglobal.__c = clear;\n\nvar modules = clear();\n\n// Don't use a Symbol here, it would pull in an extra polyfill with all sorts of\n// additional stuff (e.g. Array.from).\nvar EMPTY = {};\nvar _ref = {},\n  hasOwnProperty = _ref.hasOwnProperty;\n\nfunction clear() {\n  modules =\n    typeof __NUM_MODULES__ === \"number\"\n      ? Array(__NUM_MODULES__ | 0)\n      : Object.create(null);\n\n  // We return modules here so that we can assign an initial value to modules\n  // when defining it. Otherwise, we would have to do \"let modules = null\",\n  // which will force us to add \"nullthrows\" everywhere.\n  return modules;\n}\n\nif (__DEV__) {\n  var verboseNamesToModuleIds = Object.create(null);\n  var initializingModuleIds = [];\n}\n\nfunction define(factory, moduleId, dependencyMap) {\n  if (modules[moduleId] != null) {\n    if (__DEV__) {\n      // (We take `inverseDependencies` from `arguments` to avoid an unused\n      // named parameter in `define` in production.\n      var inverseDependencies = arguments[4];\n\n      // If the module has already been defined and the define method has been\n      // called with inverseDependencies, we can hot reload it.\n      if (inverseDependencies) {\n        global.__accept(moduleId, factory, dependencyMap, inverseDependencies);\n      } else {\n        console.warn(\n          \"Trying to define twice module ID \" + moduleId + \" in the same bundle\"\n        );\n      }\n    }\n\n    // prevent repeated calls to `global.nativeRequire` to overwrite modules\n    // that are already loaded\n    return;\n  }\n  modules[moduleId] = {\n    dependencyMap: dependencyMap,\n    factory: factory,\n    hasError: false,\n    importedAll: EMPTY,\n    importedDefault: EMPTY,\n    isInitialized: false,\n    publicModule: { exports: {} }\n  };\n  if (__DEV__) {\n    // HMR\n    modules[moduleId].hot = createHotReloadingObject();\n\n    // DEBUGGABLE MODULES NAMES\n    // we take `verboseName` from `arguments` to avoid an unused named parameter\n    // in `define` in production.\n    var _verboseName = arguments[3];\n    if (_verboseName) {\n      modules[moduleId].verboseName = _verboseName;\n      verboseNamesToModuleIds[_verboseName] = moduleId;\n    }\n  }\n}\n\nfunction metroRequire(moduleId) {\n  if (__DEV__ && typeof moduleId === \"string\") {\n    var _verboseName2 = moduleId;\n    moduleId = verboseNamesToModuleIds[_verboseName2];\n    if (moduleId == null) {\n      throw new Error('Unknown named module: \"' + _verboseName2 + '\"');\n    } else {\n      console.warn(\n        'Requiring module \"' +\n          _verboseName2 +\n          '\" by name is only supported for ' +\n          \"debugging purposes and will BREAK IN PRODUCTION!\"\n      );\n    }\n  }\n\n  //$FlowFixMe: at this point we know that moduleId is a number\n  var moduleIdReallyIsNumber = moduleId;\n\n  if (__DEV__) {\n    var initializingIndex = initializingModuleIds.indexOf(\n      moduleIdReallyIsNumber\n    );\n    if (initializingIndex !== -1) {\n      var cycle = initializingModuleIds\n        .slice(initializingIndex)\n        .map(function(id) {\n          return modules[id].verboseName;\n        });\n      // We want to show A -> B -> A:\n      cycle.push(cycle[0]);\n      console.warn(\n        \"Require cycle: \" +\n          cycle.join(\" -> \") +\n          \"\\n\\n\" +\n          \"Require cycles are allowed, but can result in uninitialized values. \" +\n          \"Consider refactoring to remove the need for a cycle.\"\n      );\n    }\n  }\n\n  var module = modules[moduleIdReallyIsNumber];\n\n  return module && module.isInitialized\n    ? module.publicModule.exports\n    : guardedLoadModule(moduleIdReallyIsNumber, module);\n}\n\nfunction metroImportDefault(moduleId) {\n  if (__DEV__ && typeof moduleId === \"string\") {\n    var _verboseName3 = moduleId;\n    moduleId = verboseNamesToModuleIds[_verboseName3];\n  }\n\n  //$FlowFixMe: at this point we know that moduleId is a number\n  var moduleIdReallyIsNumber = moduleId;\n\n  if (\n    modules[moduleIdReallyIsNumber] &&\n    modules[moduleIdReallyIsNumber].importedDefault !== EMPTY\n  ) {\n    return modules[moduleIdReallyIsNumber].importedDefault;\n  }\n\n  var exports = metroRequire(moduleIdReallyIsNumber);\n  var importedDefault =\n    exports && exports.__esModule ? exports.default : exports;\n\n  return (modules[moduleIdReallyIsNumber].importedDefault = importedDefault);\n}\n\nfunction metroImportAll(moduleId) {\n  if (__DEV__ && typeof moduleId === \"string\") {\n    var _verboseName4 = moduleId;\n    moduleId = verboseNamesToModuleIds[_verboseName4];\n  }\n\n  //$FlowFixMe: at this point we know that moduleId is a number\n  var moduleIdReallyIsNumber = moduleId;\n\n  if (\n    modules[moduleIdReallyIsNumber] &&\n    modules[moduleIdReallyIsNumber].importedAll !== EMPTY\n  ) {\n    return modules[moduleIdReallyIsNumber].importedAll;\n  }\n\n  var exports = metroRequire(moduleIdReallyIsNumber);\n  var importedAll = void 0;\n\n  if (exports && exports.__esModule) {\n    importedAll = exports;\n  } else {\n    importedAll = {};\n\n    // Refrain from using Object.assign, it has to work in ES3 environments.\n    if (exports) {\n      for (var _key in exports) {\n        if (hasOwnProperty.call(exports, _key)) {\n          importedAll[_key] = exports[_key];\n        }\n      }\n    }\n\n    importedAll.default = exports;\n  }\n\n  return (modules[moduleIdReallyIsNumber].importedAll = importedAll);\n}\n\nvar inGuard = false;\nfunction guardedLoadModule(moduleId, module) {\n  if (!inGuard && global.ErrorUtils) {\n    inGuard = true;\n    var returnValue = void 0;\n    try {\n      returnValue = loadModuleImplementation(moduleId, module);\n    } catch (e) {\n      global.ErrorUtils.reportFatalError(e);\n    }\n    inGuard = false;\n    return returnValue;\n  } else {\n    return loadModuleImplementation(moduleId, module);\n  }\n}\n\nvar ID_MASK_SHIFT = 16;\nvar LOCAL_ID_MASK = ~0 >>> ID_MASK_SHIFT;\n\nfunction unpackModuleId(moduleId) {\n  var segmentId = moduleId >>> ID_MASK_SHIFT;\n  var localId = moduleId & LOCAL_ID_MASK;\n  return { segmentId: segmentId, localId: localId };\n}\nmetroRequire.unpackModuleId = unpackModuleId;\n\nfunction packModuleId(value) {\n  return (value.segmentId << ID_MASK_SHIFT) + value.localId;\n}\nmetroRequire.packModuleId = packModuleId;\n\nvar hooks = [];\nfunction registerHook(cb) {\n  var hook = { cb: cb };\n  hooks.push(hook);\n  return {\n    release: function release() {\n      for (var i = 0; i < hooks.length; ++i) {\n        if (hooks[i] === hook) {\n          hooks.splice(i, 1);\n          break;\n        }\n      }\n    }\n  };\n}\nmetroRequire.registerHook = registerHook;\n\nfunction loadModuleImplementation(moduleId, module) {\n  if (!module && global.__defineModule) {\n    global.__defineModule(moduleId);\n    module = modules[moduleId];\n  }\n\n  var nativeRequire = global.nativeRequire;\n  if (!module && nativeRequire) {\n    var _unpackModuleId = unpackModuleId(moduleId),\n      _segmentId = _unpackModuleId.segmentId,\n      _localId = _unpackModuleId.localId;\n\n    nativeRequire(_localId, _segmentId);\n    module = modules[moduleId];\n  }\n\n  if (!module) {\n    throw unknownModuleError(moduleId);\n  }\n\n  if (module.hasError) {\n    throw moduleThrewError(moduleId, module.error);\n  }\n\n  // `metroRequire` calls into the require polyfill itself are not analyzed and\n  // replaced so that they use numeric module IDs.\n  // The systrace module will expose itself on the metroRequire function so that\n  // it can be used here.\n  // TODO(davidaurelio) Scan polyfills for dependencies, too (t9759686)\n  if (__DEV__) {\n    var Systrace = metroRequire.Systrace;\n  }\n\n  // We must optimistically mark module as initialized before running the\n  // factory to keep any require cycles inside the factory from causing an\n  // infinite require loop.\n  module.isInitialized = true;\n\n  var _module = module,\n    factory = _module.factory,\n    dependencyMap = _module.dependencyMap;\n\n  if (__DEV__) {\n    initializingModuleIds.push(moduleId);\n  }\n  try {\n    if (__DEV__) {\n      // $FlowFixMe: we know that __DEV__ is const and `Systrace` exists\n      Systrace.beginEvent(\"JS_require_\" + (module.verboseName || moduleId));\n    }\n\n    var _moduleObject = module.publicModule;\n\n    if (__DEV__) {\n      if (module.hot) {\n        _moduleObject.hot = module.hot;\n      }\n    }\n    _moduleObject.id = moduleId;\n\n    if (hooks.length > 0) {\n      for (var i = 0; i < hooks.length; ++i) {\n        hooks[i].cb(moduleId, _moduleObject);\n      }\n    }\n\n    // keep args in sync with with defineModuleCode in\n    // metro/src/Resolver/index.js\n    // and metro/src/ModuleGraph/worker.js\n    factory(\n      global,\n      metroRequire,\n      metroImportDefault,\n      metroImportAll,\n      _moduleObject,\n      _moduleObject.exports,\n      dependencyMap\n    );\n\n    // avoid removing factory in DEV mode as it breaks HMR\n    if (!__DEV__) {\n      // $FlowFixMe: This is only sound because we never access `factory` again\n      module.factory = undefined;\n      module.dependencyMap = undefined;\n    }\n\n    if (__DEV__) {\n      // $FlowFixMe: we know that __DEV__ is const and `Systrace` exists\n      Systrace.endEvent();\n    }\n    return _moduleObject.exports;\n  } catch (e) {\n    module.hasError = true;\n    module.error = e;\n    module.isInitialized = false;\n    module.publicModule.exports = undefined;\n    throw e;\n  } finally {\n    if (__DEV__) {\n      if (initializingModuleIds.pop() !== moduleId) {\n        throw new Error(\n          \"initializingModuleIds is corrupt; something is terribly wrong\"\n        );\n      }\n    }\n  }\n}\n\nfunction unknownModuleError(id) {\n  var message = 'Requiring unknown module \"' + id + '\".';\n  if (__DEV__) {\n    message +=\n      \"If you are sure the module is there, try restarting Metro Bundler. \" +\n      \"You may also want to run `yarn`, or `npm install` (depending on your environment).\";\n  }\n  return Error(message);\n}\n\nfunction moduleThrewError(id, error) {\n  var displayName = (__DEV__ && modules[id] && modules[id].verboseName) || id;\n  return Error(\n    'Requiring module \"' + displayName + '\", which threw an exception: ' + error\n  );\n}\n\nif (__DEV__) {\n  metroRequire.Systrace = {\n    beginEvent: function beginEvent() {},\n    endEvent: function endEvent() {}\n  };\n\n  metroRequire.getModules = function() {\n    return modules;\n  };\n\n  // HOT MODULE RELOADING\n  var createHotReloadingObject = function createHotReloadingObject() {\n    var hot = {\n      acceptCallback: null,\n      accept: function accept(callback) {\n        hot.acceptCallback = callback;\n      },\n      disposeCallback: null,\n      dispose: function dispose(callback) {\n        hot.disposeCallback = callback;\n      }\n    };\n    return hot;\n  };\n\n  var metroAcceptAll = function metroAcceptAll(\n    dependentModules,\n    inverseDependencies,\n    patchedModules\n  ) {\n    if (!dependentModules || dependentModules.length === 0) {\n      return true;\n    }\n\n    var notAccepted = dependentModules.filter(function(module) {\n      return !metroAccept(\n        module,\n        /*factory*/ undefined,\n        /*dependencyMap*/ undefined,\n        inverseDependencies,\n        patchedModules\n      );\n    });\n\n    var parents = [];\n    for (var i = 0; i < notAccepted.length; i++) {\n      // if the module has no parents then the change cannot be hot loaded\n      if (inverseDependencies[notAccepted[i]].length === 0) {\n        return false;\n      }\n\n      parents.push.apply(parents, inverseDependencies[notAccepted[i]]);\n    }\n\n    return parents.length == 0;\n  };\n\n  var metroAccept = function metroAccept(\n    id,\n    factory,\n    dependencyMap,\n    inverseDependencies\n  ) {\n    var patchedModules =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n    if (id in patchedModules) {\n      // Do not patch the same module more that once during an update.\n      return true;\n    }\n    patchedModules[id] = true;\n\n    var mod = modules[id];\n\n    if (!mod && factory) {\n      // New modules are going to be handled by the define() method.\n      return true;\n    }\n\n    var hot = mod.hot;\n\n    if (!hot) {\n      console.warn(\n        \"Cannot accept module because Hot Module Replacement \" +\n          \"API was not installed.\"\n      );\n      return false;\n    }\n\n    if (hot.disposeCallback) {\n      try {\n        hot.disposeCallback();\n      } catch (error) {\n        console.error(\n          \"Error while calling dispose handler for module \" + id + \": \",\n          error\n        );\n      }\n    }\n\n    // replace and initialize factory\n    if (factory) {\n      mod.factory = factory;\n    }\n    if (dependencyMap) {\n      mod.dependencyMap = dependencyMap;\n    }\n    mod.hasError = false;\n    mod.isInitialized = false;\n    metroRequire(id);\n\n    if (hot.acceptCallback) {\n      try {\n        hot.acceptCallback();\n        return true;\n      } catch (error) {\n        console.error(\n          \"Error while calling accept handler for module \" + id + \": \",\n          error\n        );\n      }\n    }\n\n    // need to have inverseDependencies to bubble up accept\n    if (!inverseDependencies) {\n      throw new Error(\"Undefined `inverseDependencies`\");\n    }\n\n    // accept parent modules recursively up until all siblings are accepted\n    return metroAcceptAll(\n      inverseDependencies[id],\n      inverseDependencies,\n      patchedModules\n    );\n  };\n\n  global.__accept = metroAccept;\n}\n","/**\n * Copyright 2018-present Facebook.\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n * @format\n */\n\nimport {\n  Panel,\n  FlexRow,\n  ElementsInspector,\n  FlexColumn,\n  ManagedDataInspector,\n  Sidebar,\n  Toolbar,\n  Checkbox,\n  FlipperPlugin,\n  Button,\n  styled,\n} from 'flipper';\nimport type {ElementID, Element} from 'flipper';\nimport {processLeaks} from './processLeakString';\n\ntype State = {\n  leaks: Leak[],\n  selectedIdx: ?number,\n  selectedEid: ?string,\n  showFullClassPaths: boolean,\n  leaksCount: number,\n};\n\ntype LeakReport = {\n  leaks: string[],\n};\n\nexport type Leak = {\n  title: string,\n  root: string,\n  elements: {[key: ElementID]: Element},\n  elementsSimple: {[key: ElementID]: Element},\n  instanceFields: {},\n  staticFields: {},\n  retainedSize: string,\n};\n\nconst Window = styled(FlexRow)({\n  height: '100%',\n  flex: 1,\n});\n\nconst ToolbarItem = styled(FlexRow)({\n  alignItems: 'center',\n  marginLeft: '8px',\n});\n\nexport default class LeakCanary extends FlipperPlugin<State> {\n  state = {\n    leaks: [],\n    selectedIdx: null,\n    selectedEid: null,\n    showFullClassPaths: false,\n    leaksCount: 0,\n  };\n\n  init() {\n    this.client.subscribe('reportLeak', (results: LeakReport) => {\n      // We only process new leaks instead of replacing the whole list in order\n      // to both avoid redundant processing and to preserve the expanded/\n      // collapsed state of the tree view\n      const newLeaks = processLeaks(results.leaks.slice(this.state.leaksCount));\n\n      let leaks = this.state.leaks;\n      for (let i = 0; i < newLeaks.length; i++) {\n        leaks.push(newLeaks[i]);\n      }\n\n      this.setState({\n        leaks: leaks,\n        leaksCount: results.leaks.length,\n      });\n    });\n  }\n\n  _clearLeaks = () => {\n    this.setState({\n      leaks: [],\n      leaksCount: 0,\n      selectedIdx: null,\n      selectedEid: null,\n    });\n    this.client.call('clear');\n  };\n\n  _selectElement = (leakIdx: number, eid: string) => {\n    this.setState({\n      selectedIdx: leakIdx,\n      selectedEid: eid,\n    });\n  };\n\n  _toggleElement = (leakIdx: number, eid: string) => {\n    const leaks = this.state.leaks;\n    const leak = leaks[leakIdx];\n\n    const element = leak.elements[eid];\n    element.expanded = !element.expanded;\n\n    const elementSimple = leak.elementsSimple[eid];\n    elementSimple.expanded = !elementSimple.expanded;\n\n    this.setState({\n      leaks: leaks,\n    });\n  };\n\n  /**\n   * Given a specific string value, determines what DataInspector type to treat\n   * it as. Ensures that numbers, bools, etc render correctly.\n   */\n  _extractValue(\n    value: any,\n    depth: number,\n  ): {|mutable: boolean, type: string, value: any|} {\n    if (!isNaN(value)) {\n      return {mutable: false, type: 'number', value: value};\n    } else if (value == 'true' || value == 'false') {\n      return {mutable: false, type: 'boolean', value: value};\n    } else if (value == 'null') {\n      return {mutable: false, type: 'null', value: value};\n    }\n    return {mutable: false, type: 'enum', value: value};\n  }\n\n  renderSidebar() {\n    const {selectedIdx, selectedEid, leaks} = this.state;\n\n    if (selectedIdx == null || selectedEid == null) {\n      return null;\n    }\n\n    const leak = leaks[selectedIdx];\n    const staticFields = leak.staticFields[selectedEid];\n    const instanceFields = leak.instanceFields[selectedEid];\n\n    return (\n      <Sidebar position=\"right\" width={600} minWidth={300} maxWidth={900}>\n        <Panel heading={'Instance'} floating={false} grow={false}>\n          <ManagedDataInspector\n            data={instanceFields}\n            expandRoot={true}\n            extractValue={this._extractValue}\n          />\n        </Panel>\n        <Panel heading={'Static'} floating={false} grow={false}>\n          <ManagedDataInspector\n            data={staticFields}\n            expandRoot={true}\n            extractValue={this._extractValue}\n          />\n        </Panel>\n      </Sidebar>\n    );\n  }\n\n  render() {\n    const {selectedIdx, selectedEid, showFullClassPaths} = this.state;\n    const sidebar = this.renderSidebar();\n\n    return (\n      <Window>\n        <FlexColumn grow={true}>\n          <FlexColumn grow={true} scrollable={true}>\n            {this.state.leaks.map((leak: Leak, idx: number) => {\n              const elements = showFullClassPaths\n                ? leak.elements\n                : leak.elementsSimple;\n              const selected = selectedIdx == idx ? selectedEid : null;\n              return (\n                <Panel\n                  collapsable={false}\n                  padded={false}\n                  heading={leak.title}\n                  floating={false}\n                  accessory={leak.retainedSize}>\n                  <ElementsInspector\n                    onElementSelected={eid => {\n                      this._selectElement(idx, eid);\n                    }}\n                    onElementHovered={() => {}}\n                    onElementExpanded={(eid, deep) => {\n                      this._toggleElement(idx, eid);\n                    }}\n                    onValueChanged={() => {}}\n                    selected={selected}\n                    searchResults={null}\n                    root={leak.root}\n                    elements={elements}\n                  />\n                </Panel>\n              );\n            })}\n          </FlexColumn>\n          <Toolbar>\n            <ToolbarItem>\n              <Button onClick={this._clearLeaks}>Clear</Button>\n            </ToolbarItem>\n            <ToolbarItem>\n              <Checkbox\n                checked={showFullClassPaths}\n                onChange={(checked: boolean) => {\n                  this.setState({showFullClassPaths: checked});\n                }}\n              />\n              Show full class path\n            </ToolbarItem>\n          </Toolbar>\n        </FlexColumn>\n        {sidebar}\n      </Window>\n    );\n  }\n}\n","/**\n * Copyright 2018-present Facebook.\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n * @format\n * @flow\n */\n\nimport type {Leak} from './index.js';\nimport type {Element} from 'flipper';\n\n/**\n * Creates an Element (for ElementsInspector) representing a single Object in\n * the path to GC root view.\n */\nfunction getElementSimple(str: string, id: string): Element {\n  // Below regex can handle both older and newer versions of LeakCanary\n  const match = str.match(\n    /\\* (GC ROOT )?(\\u21B3 )?([a-z]* )?([^A-Z]*.)?([A-Z].*)/,\n  );\n  let name = 'N/A';\n  if (match) {\n    name = match[5];\n  }\n  return {\n    id: id,\n    name: name,\n    expanded: true,\n    children: [],\n    attributes: [],\n    data: {},\n    decoration: '',\n    extraInfo: {},\n  };\n}\n\n// Line marking the start of Details section\nconst BEGIN_DETAILS_SECTION_INDICATOR = '* Details:';\n// Line following the end of the Details section\nconst END_DETAILS_SECTION_INDICATOR = '* Excluded Refs:';\nconst STATIC_PREFIX = 'static ';\n// Text that begins the line of the Object at GC root\nconst LEAK_BEGIN_INDICATOR = 'has leaked:';\nconst RETAINED_SIZE_INDICATOR = '* Retaining: ';\n\n/**\n * Parses the lines given (at the given index) to extract information about both\n * static and instance fields of each class in the path to GC root. Returns three\n * objects, each one mapping the element ID of a specific element to the\n * corresponding static fields, instance fields, or package name of the class\n */\nfunction generateFieldsList(\n  lines: string[],\n  i: number,\n): {|staticFields: {}, instanceFields: {}, packages: {}|} {\n  let staticFields = {};\n  let instanceFields = {};\n\n  let staticValues = {};\n  let instanceValues = {};\n\n  let elementId = -1;\n  let elementIdStr = String(-1);\n\n  let packages = {};\n\n  // Process everything between Details and Excluded Refs\n  while (\n    i < lines.length &&\n    !lines[i].startsWith(END_DETAILS_SECTION_INDICATOR)\n  ) {\n    const line = lines[i];\n    if (line.startsWith('*')) {\n      if (elementId != -1) {\n        staticFields[elementIdStr] = staticValues;\n        instanceFields[elementIdStr] = instanceValues;\n        staticValues = {};\n        instanceValues = {};\n      }\n      elementId++;\n      elementIdStr = String(elementId);\n\n      // Extract package for each class\n      let pkg = 'unknown';\n      const match = line.match(/\\* (.*)(of|Class) (.*)/);\n      if (match) {\n        pkg = match[3];\n      }\n      packages[elementIdStr] = pkg;\n    } else {\n      // Field/value pairs represented in input lines as\n      // | fieldName = value\n      const match = line.match(/\\|\\s+(.*) = (.*)/);\n      if (match) {\n        const fieldName = match[1];\n        const fieldValue = match[2];\n\n        if (fieldName.startsWith(STATIC_PREFIX)) {\n          const strippedFieldName = fieldName.substr(7);\n          staticValues[strippedFieldName] = fieldValue;\n        } else {\n          instanceValues[fieldName] = fieldValue;\n        }\n      }\n    }\n    i++;\n  }\n  staticFields[elementIdStr] = staticValues;\n  instanceFields[elementIdStr] = instanceValues;\n\n  return {\n    staticFields: staticFields,\n    instanceFields: instanceFields,\n    packages: packages,\n  };\n}\n\n/**\n * Processes a LeakCanary string containing data from a single leak. If the\n * string represents a valid leak, the function appends parsed data to the given\n * output list. If not, the list is returned as-is. This parsed data contains\n * the path to GC root, static/instance fields for each Object in the path, the\n * leak's retained size, and a title for the leak.\n */\nfunction processLeak(output: Leak[], leakInfo: string): Leak[] {\n  const lines = leakInfo.split('\\n');\n\n  // Elements shows a Object's classname and package, wheras elementsSimple shows\n  // just its classname\n  let elements = {};\n  let elementsSimple = {};\n\n  let rootElementId = '';\n\n  let i = 0;\n  while (i < lines.length && !lines[i].endsWith(LEAK_BEGIN_INDICATOR)) {\n    i++;\n  }\n  i++;\n\n  if (i >= lines.length) {\n    return output;\n  }\n\n  let elementId = 0;\n  let elementIdStr = '';\n  while (i < lines.length && lines[i].startsWith('*')) {\n    const line = lines[i];\n\n    elementIdStr = String(elementId);\n    const prevIdStr = String(elementId - 1);\n    if (elementId !== 0) {\n      // Add element to previous element's children\n      elements[prevIdStr].children.push(elementIdStr);\n      elementsSimple[prevIdStr].children.push(elementIdStr);\n    } else {\n      rootElementId = elementIdStr;\n    }\n    elements[elementIdStr] = getElementSimple(line, elementIdStr);\n    elementsSimple[elementIdStr] = getElementSimple(line, elementIdStr);\n\n    i++;\n    elementId++;\n  }\n  // Last element is leaked object\n  const leakedObjName = elements[elementIdStr].name;\n\n  while (\n    i < lines.length &&\n    !lines[i].startsWith(RETAINED_SIZE_INDICATOR) &&\n    !lines[i].startsWith(BEGIN_DETAILS_SECTION_INDICATOR)\n  ) {\n    i++;\n  }\n\n  let retainedSize = 'unknown size';\n\n  if (lines[i].startsWith(RETAINED_SIZE_INDICATOR)) {\n    const match = lines[i].match(/\\* Retaining: (.*)./);\n    if (match) {\n      retainedSize = match[1];\n    }\n  }\n\n  while (\n    i < lines.length &&\n    !lines[i].startsWith(BEGIN_DETAILS_SECTION_INDICATOR)\n  ) {\n    i++;\n  }\n  i++;\n\n  // Parse information on each object's fields, package\n  const {staticFields, instanceFields, packages} = generateFieldsList(lines, i);\n\n  // While elementsSimple remains as-is, elements has the package of each class\n  // inserted, in order to enable 'Show full class path'\n  Object.keys(packages).forEach(elementId => {\n    const pkg = packages[elementId];\n    const simpleName = elements[elementId].name;\n    // Gets everything before the field name, which is replaced by the package\n    const match = simpleName.match(/([^\\. ]*)(.*)/);\n    if (match) {\n      elements[elementId].name = pkg + match[2];\n    }\n  });\n\n  output.push({\n    root: rootElementId,\n    elements: elements,\n    elementsSimple: elementsSimple,\n    staticFields: staticFields,\n    instanceFields: instanceFields,\n    title: leakedObjName,\n    retainedSize: retainedSize,\n  });\n  return output;\n}\n\n/**\n * Processes a set of LeakCanary strings, ignoring non-leaks - see processLeak above.\n */\nexport function processLeaks(leakInfos: string[]): Leak[] {\n  const newLeaks = leakInfos.reduce(processLeak, []);\n  return newLeaks;\n}\n"],"names":["global","__r","metroRequire","__d","define","__c","clear","modules","EMPTY","_ref","hasOwnProperty","__NUM_MODULES__","Array","Object","create","factory","moduleId","dependencyMap","hasError","importedAll","importedDefault","isInitialized","publicModule","exports","moduleIdReallyIsNumber","module","guardedLoadModule","metroImportDefault","__esModule","default","metroImportAll","_key","call","inGuard","ErrorUtils","returnValue","loadModuleImplementation","e","reportFatalError","ID_MASK_SHIFT","LOCAL_ID_MASK","unpackModuleId","segmentId","localId","packModuleId","value","hooks","registerHook","cb","hook","push","release","i","length","splice","__defineModule","nativeRequire","_unpackModuleId","_segmentId","_localId","unknownModuleError","moduleThrewError","error","_module","_moduleObject","id","undefined","message","Error","displayName","Window","FlexRow","height","flex","ToolbarItem","alignItems","marginLeft","LeakCanary","FlipperPlugin","leaks","selectedIdx","selectedEid","showFullClassPaths","leaksCount","setState","client","leakIdx","eid","state","leak","element","elements","expanded","elementSimple","elementsSimple","init","subscribe","results","newLeaks","slice","_extractValue","depth","isNaN","mutable","type","renderSidebar","staticFields","instanceFields","render","sidebar","map","idx","selected","title","retainedSize","_selectElement","deep","_toggleElement","root","_clearLeaks","checked","getElementSimple","str","match","name","children","attributes","data","decoration","extraInfo","BEGIN_DETAILS_SECTION_INDICATOR","END_DETAILS_SECTION_INDICATOR","STATIC_PREFIX","LEAK_BEGIN_INDICATOR","RETAINED_SIZE_INDICATOR","generateFieldsList","lines","staticValues","instanceValues","elementId","elementIdStr","String","packages","startsWith","line","pkg","fieldName","fieldValue","strippedFieldName","substr","processLeak","output","leakInfo","split","rootElementId","endsWith","prevIdStr","leakedObjName","keys","forEach","simpleName","processLeaks","leakInfos","reduce"],"mappings":"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"}